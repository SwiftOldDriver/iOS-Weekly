# è€å¸æœº iOS å‘¨æŠ¥ #61 | 2019-03-26

![ios-weekly](https://github.com/SwiftOldDriver/iOS-Weekly/blob/master/assets/ios-weekly.png?raw=true)
è€å¸æœº iOS å‘¨æŠ¥ï¼Œåªä¸ºä½ å‘ˆç°æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚

ä½ ä¹Ÿå¯ä»¥ä¸ºè¿™ä¸ªé¡¹ç›®å‡ºä¸€ä»½åŠ›ï¼Œå¦‚æœå‘ç°æœ‰ä»·å€¼çš„ä¿¡æ¯ã€æ–‡ç« ã€å·¥å…·ç­‰å¯ä»¥åˆ° [Issues](https://github.com/SwiftOldDriver/iOS-Weekly/issues) é‡Œæç»™æˆ‘ä»¬ï¼Œæˆ‘ä»¬ä¼šå°½å¿«å¤„ç†ã€‚è®°å¾—å†™ä¸Šæ¨èçš„ç†ç”±å“¦ã€‚æœ‰å»ºè®®å’Œæ„è§ä¹Ÿæ¬¢è¿åˆ° [Issues](https://github.com/SwiftOldDriver/iOS-Weekly/issues) æå‡ºã€‚

## åŠ²çˆ†æ–°é—»

### [Swift 5 Release Notes for Xcode 10.2](https://developer.apple.com/documentation/xcode_release_notes/xcode_10_2_release_notes/swift_5_release_notes_for_xcode_10_2)

ä»¥ä¸‹æ˜¯ç¿»è¯‘éƒ¨åˆ†

Swift5 æ­£å¼æ›´æ–°

- æ¦‚è¦
  åœ¨ Xcode10.2 ç‰ˆæœ¬ä¸­ï¼Œå°†å¯ä»¥ä½¿ç”¨ Swift5.0 è¿›è¡Œå¼€å‘

- æ€»ä½“ï¼ˆGeneralï¼‰

  #### Swift 5 Runtime Support for Command Line Tools Package

  - Swift å‘½ä»¤è¡Œå·¥å…·ä» Xcode 10.2 å¼€å§‹éœ€è¦ä¾èµ–äº macOS ä¸­çš„Swiftåº“ã€‚è¿™äº›åº“å°†ä» macOS Mojave 10.14.4 å¼€å§‹é»˜è®¤åŒ…å«åœ¨ macOS ä¸­ã€‚åœ¨ macOS Mojave 10.14.3 å’Œæ›´æ—©çš„ç‰ˆæœ¬ä¸­ï¼Œå¯ä»¥é€‰æ‹©ä»  [More Downloads for Apple Developers](https://developer.apple.com/download/more/) ä¸‹è½½ Swift å‘½ä»¤è¡Œå·¥å…·æ‰€éœ€è¦çš„è¿è¡Œæ—¶åº“ã€‚å¦‚æœä½ å®‰è£…äº† beta ç‰ˆæœ¬ï¼Œéœ€è¦å°†å…¶æ›¿æ¢æˆæ­£å¼ç‰ˆæœ¬ã€‚åªæœ‰åœ¨ Swift å‘½ä»¤è¡Œå·¥å…·ä¸­æ‰éœ€è¦è¿™ä¸ªåŒ…ï¼Œè€Œå¹¶ä¸é€‚ç”¨äºå…·æœ‰å›¾å½¢ç”¨æˆ·ç•Œé¢çš„åº”ç”¨ç¨‹åºã€‚

- App ç˜¦èº«ï¼ˆApp Thinningï¼‰


#### æ–°ç‰¹æ€§

  - Swift ä¸å†åŒ…å« Swift æ ‡å‡†åº“çš„åŠ¨æ€é“¾æ¥ï¼Œå¹¶ä¸”ä¼šåœ¨ iOS 12.2, watchOS 5.2, and tvOS 12.2 çš„æ„å»ºç‰ˆæœ¬ä¸­åŒ…å« Swift SDK ã€‚ä»è€Œ Swift apps åœ¨ä½ ä¸Šä¼  App Store ï¼Œå‘å¸ƒ TestFlight æµ‹è¯•ï¼Œå’Œæœ¬åœ°æ‰“åŒ…æ—¶ä¼šå˜å¾—æ›´å°ã€‚

    æƒ³è¦æ¯”è¾ƒåº”ç”¨åœ¨ iOS 12.2 å’Œ iOS 12.1 ä¹‹å‰ç‰ˆæœ¬ç˜¦èº«çš„å¤§å°çš„åŒºåˆ«ï¼Œä½ å¯ä»¥æŠŠåº”ç”¨çš„ deployment target è®¾ä¸º iOS 12.1 æˆ–ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œç„¶åå°†scheme è®¾ä¸º Generic iOS Device ç”Ÿæˆä¸€ä¸ªå½’æ¡£æ–‡ä»¶ã€‚ç„¶åç”¨é€‰æ‹© Archives organizer ä¸­çš„å‘å¸ƒåº”ç”¨ä¸­çš„ Development distributionã€‚ç¡®å®šåœ¨ App Thinning çš„ä¸‹æ‹‰èœå•ä¸­é€‰ä¸­æŸä¸ªç‰¹å®šçš„è®¾å¤‡å¦‚ï¼šiPhone XS ã€‚å½“å‘å¸ƒå®Œæˆä»¥åï¼Œåœ¨åˆšåˆšåˆ›å»ºçš„æ–‡ä»¶å¤¹ä¸­æ‰“å¼€ App Thinning Size Report ï¼Œå¯ä»¥çœ‹åˆ° iOS 12.2 çš„å®‰è£…åŒ…è¦æ¯” iOS 12.1 æˆ–è€…æ›´æ—©çš„ç‰ˆæœ¬è¦å°ã€‚å‡†ç¡®çš„å¤§å°å·®åˆ«å–å†³äºä½ çš„ app ä½¿ç”¨ç³»ç»Ÿæ¡†æ¶çš„æ•°é‡ã€‚

    æƒ³è¦è·å–æ›´å¤š app ç˜¦èº«çš„ä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒ [Xcode Help](https://help.apple.com/xcode/mac/current/) ä¸­çš„  [What is app thinning?](https://help.apple.com/xcode/mac/current/#/devbbdc5ce4f) ã€‚

    è·å–æ›´å¤š appæ–‡ä»¶å¤§å°çš„ä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒ [App Store Connect Help](https://help.apple.com/app-store-connect/) ä¸­çš„  [View builds and file sizes](https://help.apple.com/app-store-connect/#/dev3b56ce97c) ã€‚

### Swift è¯­è¨€ç‰¹æ€§ï¼ˆSwift Languageï¼‰

#### æ–°ç‰¹æ€§
* å­—ç¬¦ä¸²çš„å£°æ˜ï¼Œç°åœ¨å¯ä»¥ä½¿ç”¨æ›´å¥½ç”¨çš„åˆ†éš”ç¬¦äº†ã€‚å½“ä½¿ç”¨ï¼ˆ#ï¼‰å·æ¥åŒ…ä½ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨å¤šä¸ªï¼ˆ#ï¼‰å·æ¥åˆ†å‰²çº¯å­—ç¬¦å’Œå˜é‡å£°æ˜ã€‚ä½¿ç”¨å¢å¼ºçš„åˆ†éš”ç¬¦ï¼Œå¯ä»¥é¿å…å†™å¾—å¾ˆæ··ä¹±çš„å­—ç¬¦ä¸²è½¬ä¹‰å£°æ˜ã€‚ï¼ˆ[SE-0200](https://github.com/apple/swift-evolution/blob/master/proposals/0200-raw-string-escaping.md)ï¼‰ï¼ˆ47725014ï¼‰ï¼š
```swift
print(#"<a href="\#(url)" title="Apple Developer">"#)
// ç­‰ä»·äº:
print("<a href=\"\(url)\" title=\"Apple Developer\">")
```

* å¦‚æœå£°æ˜çš„ç±»å‹ä¸æ ‡å‡†åº“ä¸­çš„ç±»å‹å…·æœ‰ç›¸åŒçš„åç§°ï¼Œåˆ™ä¼šè¦†ç›–äº†æ ‡å‡†åº“ä¸­çš„ç±»å‹å£°æ˜ã€‚ï¼ˆ46767892ï¼‰

ä¾‹å¦‚ï¼Œåœ¨æ¨¡å— Foo ä¸­å£°æ˜äº†ä¸€ä¸ªç±»å‹ï¼Œåå­—æ˜¯ Result
```swift
// Module `Foo`.
public enum Result<T> {
    case value(T)
    case error(Error)
}
```

è¿™æ ·åœ¨ä»»ä½•ä½¿ç”¨äº† Foo æ¨¡å—çš„ä»£ç ä¸­ï¼ŒResult ç±»å‹éƒ½å°†è¢«è®¤ä¸ºæ˜¯```Foo.Result```ï¼š
```Swift
import Foo
func doSomething() -> Result<Int> { /* â€¦ */ }
```

é‚£ä¹ˆå¦‚æœçœŸçš„æƒ³è¦å¼•ç”¨æ ‡å‡†åº“ä¸­çš„[Result](https://developer.apple.com/documentation/swift/result)ç±»å‹ï¼Œé‚£ä¹ˆå¿…é¡»åŠ ä¸Šæ˜¾å¼çš„å£°æ˜ï¼š

```swift
import Foo
func useStandardLibraryResult() -> Swift.Result<Int, Error> { /* â€¦ */ }
```

* å¦‚æœä¸€ä¸ªå˜é‡å£°æ˜ä¸º```@dynamicCallable```çš„è¯ï¼Œè¿™æ ·å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå‡½æ•°è°ƒç”¨çš„è¯­æ³•ç³–ï¼Œè¿™ä¸ªè¯­æ³•ç³–ä¸»è¦çš„ä½¿ç”¨åœºæ™¯æ˜¯åŠ¨æ€è¯­è¨€äº’æ“ä½œï¼ˆ[SE-0216](https://github.com/apple/swift-evolution/blob/master/proposals/0216-dynamic-callable.md)ï¼‰ï¼ˆ47325423ï¼‰

ä¾‹å¦‚ï¼š
```swift
@dynamicCallable struct ToyCallable {
    func dynamicallyCall(withArguments: [Int]) {}
    func dynamicallyCall(withKeywordArguments: KeyValuePairs<String, Int>) {}
}

let x = ToyCallable()

x(1, 2, 3)
// ä¸Šé¢çš„ä»£ç å®é™…ä¸Šæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œå¦‚æœä¸ç”¨è¯­æ³•ç³–çš„è¯ï¼Œä»£ç ä¼šåƒè¿™æ ·å­å†™  `x.dynamicallyCall(withArguments: [1, 2, 3])`

x(label: 1, 2)
// ä¸Šé¢çš„ä»£ç å®é™…ä¸Šæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œå¦‚æœä¸ç”¨è¯­æ³•ç³–çš„è¯ï¼Œä»£ç ä¼šåƒè¿™æ ·å­å†™   `x.dynamicallyCall(withKeywordArguments: ["label": 1, "": 2])`
```

* ```æ ‡è¯†é”®è·¯å¾„ï¼ˆKey pathsï¼‰```åŠŸèƒ½ç°åœ¨æ”¯æŒä¸€ä¸ªç‰¹æ®Šçš„æ ‡è®°æ–¹å¼```ï¼ˆ\.selfï¼‰```ï¼Œ[WritableKeyPath](https://developer.apple.com/documentation/swift/writablekeypath)æŒ‡ä»£äº†æ•´ä¸ªè¾“å…¥å€¼[SE-0227](https://github.com/apple/swift-evolution/blob/master/proposals/0227-identity-keypath.md)ï¼‰ï¼ˆ40538312ï¼‰

```swift
let id = \Int.self
var x = 2
print(x[keyPath: id]) // Prints "2"
x[keyPath: id] = 3
print(x[keyPath: id]) // Prints "3"
```

* åœ¨ Swift5 ä¹‹å‰ï¼Œå¯ä»¥ç¼–å†™ä¸€ä¸ªå¸¦æœ‰å¯å˜å‚æ•°çš„æšä¸¾ä½“ï¼š

```swift
enum X {
    case foo(bar: Int...) 
}
â€¨func baz() -> X {
    return .foo(bar: 0, 1, 2, 3) 
} 
```
è¿™ä¸æ˜¯ä¸€ä¸ªç‰¹æ„æ”¯æŒçš„ç‰¹æ€§ï¼Œç°åœ¨ä¼šäº§ç”Ÿç¼–è¯‘é”™è¯¯äº†ã€‚ï¼ˆ46821582ï¼‰
ç›¸å¯¹åœ°ï¼Œä½ å¯ä»¥ç”¨æ•°ç»„çš„å£°æ˜æ¥ä»£æ›¿å¯å˜å‚æ•°å£°æ˜ï¼š

```swift
enum X {
    case foo(bar: [Int]) 
} 
â€¨func baz() -> X {
    return .foo(bar: [0, 1, 2, 3]) 
} 
```

* åœ¨ Swift5 ä¸‹ï¼Œ```try?```å¦‚æœç”¨åœ¨[å¯é€‰ç±»å‹](https://developer.apple.com/documentation/swift/optional)ä¸Šçš„è¯ï¼Œå°±ç®—æ˜¯å¤šå±‚ä½¿ç”¨ï¼Œä¹Ÿä¸ä¼šå¯¼è‡´è¿”å›å€¼æ˜¯ä¸€ä¸ªå¤šå±‚åµŒå¥—çš„å¯é€‰ç±»å‹äº†ã€‚ï¼ˆ[SE-0230](https://github.com/apple/swift-evolution/blob/master/proposals/0230-flatten-optional-try.md)ï¼‰ï¼ˆ47313584ï¼‰

* å¦‚æœä¸€ä¸ªç±»å‹```T```ç¬¦åˆ[Initialization with Literals](https://developer.apple.com/documentation/swift/swift_standard_library/initialization_with_literals)ä¸­çš„ä¸€ä¸ªåè®®ï¼Œä¾‹å¦‚[ExpressibleByIntegerLiteral](https://developer.apple.com/documentation/swift/expressiblebyintegerliteral)ï¼Œå¹¶ä¸”æ˜¯ä¸€ä¸ªæ ‡é‡è¡¨è¾¾å¼çš„è¯ï¼Œé‚£ä¹ˆå°†ä¸éœ€è¦ä¸€ç›´ä½¿ç”¨```T```ç”¨åœ¨æ³›å‹åè®®å£°æ˜ä¸­äº†

ä¾‹å¦‚ï¼šç°åœ¨å¯ä»¥è¿™æ ·å­å†™ä¸€ä¸ªå˜é‡è¡¨è¾¾å¼
```swift
UInt64(0xffff_ffff_ffff_ffff) 
```
åœ¨ä¹‹å‰çš„ç‰ˆæœ¬çš„è¯å°†ä¼šå¯¼è‡´[Int](https://developer.apple.com/documentation/swift/int)æº¢å‡ºé”™è¯¯ã€‚ï¼ˆ[SE-0213](https://github.com/apple/swift-evolution/blob/master/proposals/0213-literal-init-via-coercion.md)ï¼‰ï¼ˆ17088188ï¼‰

   
* å­—ç¬¦ä¸²æ’å…¥å¤§å¹…æé«˜äº†æ€§èƒ½è¡¨ç°ã€‚ï¼ˆ[SE-0228](https://github.com/apple/swift-evolution/blob/master/proposals/0228-fix-expressiblebystringinterpolation.md)ï¼‰ï¼ˆ43621912ï¼‰

* ä¸€ä¸ªæ—§çš„åè®®```_ExpressibleByStringInterpolation```è¢«ç§»é™¤äº†ã€‚å¦‚æœä½ å¸Œæœ›ç»§ç»­ä½¿ç”¨è¿™ä¸ªåè®®çš„è¯ï¼Œä½ å¯ä»¥é€šè¿‡æ¡ä»¶ç¼–è¯‘é€‰é¡¹æ¥å®ç°æ–°è€æ¿æœ¬çš„å…¼å®¹ã€‚

ä¾‹å¦‚ï¼š
```swift
#if compiler(<5)
extension MyType: _ExpressibleByStringInterpolation { /*...*/ }
#else
extension MyType: ExpressibleByStringInterpolation { /*...*/ }
#endif 
```

- Swift æ ‡å‡†åº“ï¼ˆSwift Standard Libraryï¼‰

#### æ–°ç‰¹æ€§

*   æ ‡å‡†åº“ç°åœ¨åŒ…æ‹¬ `Result` æšä¸¾ ` Result.success(_:)` å’Œ `Result.failure(_:)` ã€‚åœ¨`do-catch` è¯­å¥å’Œ `try` è¡¨è¾¾å¼ä¸èƒ½ä½¿ç”¨çš„æƒ…å†µä¸‹(ä¾‹å¦‚åœ¨ä½¿ç”¨å¯èƒ½å¤±è´¥çš„å¼‚æ­¥apiæ—¶)ï¼Œä½¿ç”¨ `Result` æ‰‹åŠ¨ä¼ é€’å’Œå¤„ç†é”™è¯¯ã€‚

    ä½œä¸ºæ·»åŠ çš„ä¸€éƒ¨åˆ†ï¼Œ`Error` åè®®çš„è‡ªæˆ‘ä¸€è‡´æ€§ï¼Œè¿™ä½¿å¾—åœ¨é€šç”¨ä¸Šä¸‹æ–‡ä¸­å¤„ç†é”™è¯¯æ›´åŠ å®¹æ˜“ã€‚(SE-0235)(21200405)

*   [SIMD](https://developer.apple.com/documentation/swift/simd) ç±»å‹å’ŒåŸºæœ¬æ“ä½œç¬¦ç°åœ¨åœ¨æ ‡å‡†åº“ä¸­å®šä¹‰ã€‚åœ¨ `simd` æ¡†æ¶æä¾›çš„ç±»å‹ä¸­ï¼Œ [float2](https://developer.apple.com/documentation/simd/float2) å’Œ [float3](https://developer.apple.com/documentation/simd/float3)ï¼Œç°åœ¨æ˜¯æ–°æ ‡å‡†åº“ç±»å‹çš„ç±»å‹åˆ«åã€‚
    
    `SIMD` ç±»å‹æ˜¯æ ‡é‡å…ƒç´ ç±»å‹ä¸Šçš„æ³›å‹ã€‚ä¾‹å¦‚ï¼Œæ—§çš„ [float3](https://developer.apple.com/documentation/simd/float3) ç±»å‹æ˜¯ `SIMD3<Float>` çš„ç±»å‹åˆ«åã€‚ä»»ä½•ç¬¦åˆ [SIMDScalar](https://developer.apple.com/documentation/swift/simdscalar) åè®®çš„ç±»å‹éƒ½å¯ä»¥ç”¨ä½œ `SIMD` å‘é‡çš„æ ‡é‡ç±»å‹ï¼Œä½†æ˜¯æœ‰æ•ˆçš„å‘é‡åŒ–ä¾èµ–äºä¸ºç›¸å…³çš„ [SIMDStorage](https://developer.apple.com/documentation/swift/simdstorage) ç±»å‹é€‰æ‹©ä¸€ä¸ªè‰¯å¥½çš„æ•°æ®å¸ƒå±€å¹¶è¿›è¡Œæœ‰æ•ˆçš„ä¸‹æ ‡æ“ä½œã€‚
   
    å¤§å¤šæ•°ä½¿ç”¨ `simd` ç±»å‹çš„ç°æœ‰ä»£ç å¯ä»¥ç»§ç»­ä½¿ç”¨æ–°çš„æ³›å‹ `simd` ç±»å‹ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„ä¸€äº›æ›´æ”¹ã€‚
   
    æ–°ç±»å‹å¢åŠ äº†ä¸€äº›æ–°çš„ä¸€è‡´æ€§; [SIMD](https://developer.apple.com/documentation/swift/simd) å‘é‡ç°åœ¨æ˜¯ [Hashable](https://developer.apple.com/documentation/swift/hashable) ã€[Equatable](https://developer.apple.com/documentation/swift/equatable) å’Œ [Codable](https://developer.apple.com/documentation/swift/codable)ã€‚è¿™å¯èƒ½å…è®¸æ‚¨åˆ é™¤åœ¨æ‚¨è‡ªå·±çš„ä»£ç ä¸­æä¾›è¿™äº›ä¸€è‡´æ€§çš„ä¸€äº›ç°æœ‰æ‰©å±•ã€‚
    
    ä¸ºæä¾›å‘é‡æ ‡é‡ç®—æ³•è€Œé‡è½½çš„è¿ç®—ç¬¦é›†å¾—åˆ°äº†æå¤§çš„æ‰©å±•ã€‚è¿™ä½¿å¾—ç¼–å†™ä¸€äº›ä¸œè¥¿å˜å¾—æ›´å®¹æ˜“ï¼Œä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ä¼šç»™ `typechecker` å¸¦æ¥æ­§ä¹‰ï¼Œå¹¶ä¸”å¯èƒ½éœ€è¦åˆ†è§£ä¸€äº›è¡¨è¾¾å¼æˆ–ä½¿ç”¨æ˜¾å¼ç±»å‹è¿›è¡Œæ³¨é‡Šã€‚

    ç”±äºç°åœ¨çš„ç±»å‹æ˜¯æ³›å‹è€Œä¸æ˜¯å…·ä½“çš„ï¼Œå¦‚æœæ‚¨å·²ç»åœ¨ `simd` æ¡†æ¶ç±»å‹ä¸Šå®šä¹‰äº†è‡ªå·±çš„åè®®ï¼Œé‚£ä¹ˆå¯èƒ½æœ‰å¿…è¦é‡æ„ä¸€è‡´æ€§ï¼Œå› ä¸º `Swift` æ³›å‹ç±»å‹ä¸èƒ½å¯¹åè®®æœ‰å¤šä¸ªæ¡ä»¶ä¸€è‡´æ€§ã€‚è¿™ç§æƒ…å†µç›¸å¯¹æ¯”è¾ƒå°‘è§ï¼Œä½†é€šå¸¸éœ€è¦é‡æ„å¦‚ä¸‹ä»£ç :

    ```swift
    protocol MyVectorProtocol { /* ... */ }
    extension float2: MyVectorProtocol { /* ... */ }
    extension double2: MyVectorProtocol { /* ... */ }

    ```

    è¦æ”¹ä¸ºä½¿ç”¨ä»¥ä¸‹ç»“æ„ï¼š

    ```swift
    protocol MySIMDScalarProtocol: SIMDScalar { /* ... */ }
    extension SIMD2 where Scalar: MySIMDScalarProtocol { /* ... */ }
    // Or even:
    protocol MySIMDScalarProtocol: SIMDScalar { /* ... */ }
    extension SIMD where Scalar: MySIMDScalarProtocol { /* ... */ }
    ```

    è¿™ç§æ›´æ”¹é€šå¸¸å…è®¸æ‚¨åˆ é™¤è®¸å¤šå†—ä½™å®ç°ï¼Œä½†å®ƒè¦æ±‚æ‚¨å®šä¹‰ä»»ä½•å¿…è¦çš„å®ç° `Hook`ï¼Œè¿™äº› `Hook` å¼•ç”¨ `Darwin` ç³»ç»Ÿä¸Šæ ‡é‡ç±»å‹çš„Cå¤´æ–‡ä»¶ä¸­çš„å…·ä½“å‡½æ•°ã€‚(SE-0229)(17045503)

*   [Set](https://developer.apple.com/documentation/swift/set) å’Œ [Dictionary](https://developer.apple.com/documentation/swift/dictionary) ç°åœ¨ä¸ºæ¯ä¸ªæ–°åˆ›å»ºçš„å®ä¾‹ä½¿ç”¨ä¸åŒçš„æ•£åˆ—ç§å­ã€‚å› æ­¤ï¼Œåœ¨ [Set](https://developer.apple.com/documentation/swift/set) å’Œ [Dictionary](https://developer.apple.com/documentation/swift/dictionary) ä¸­ï¼Œå…ƒç´ çš„é¡ºåºæ¯æ¬¡éƒ½ä¼šæ”¹å˜:

    ```swift
    let a: Set<Int> = [1, 2, 3, 4, 5]
    let b: Set<Int> = [1, 2, 3, 4, 5]
    a == b  // true
    print(a) // [1, 4, 3, 2, 5]
    print(b) // [4, 2, 5, 1, 3]
    ```

    ç°æœ‰çš„ä»£ç é”™è¯¯åœ°å‡è®¾ä¸¤ä¸ªä¸ç›¸å…³ä½†ç›¸ç­‰çš„é›†åˆæˆ–å­—å…¸å°†ä»¥ç›¸åŒçš„é¡ºåºåŒ…å«å…ƒç´ ï¼Œè¿™åœ¨ `Swift 5` ä¸­æ›´å®¹æ˜“äº§ç”Ÿé”™è¯¯çš„ç»“æœã€‚å°½ç®¡å…ƒç´ é¡ºåºåœ¨ä¸åŒçš„ `Set` æˆ– `Dictionary` å®ä¾‹ä¹‹é—´å¹¶ä¸ç¨³å®šï¼Œä½†æ˜¯åœ¨åŒä¸€ä¸ªå®ä¾‹ä¸Šçš„å¤šæ¬¡è¿­ä»£ä¹‹é—´ï¼Œé¡ºåºä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚é™¤äº†å¼ºè°ƒè¿™äº›é›†åˆä¸èƒ½ä¿è¯ä¸€è‡´çš„å…ƒç´ é¡ºåºå¤–ï¼Œæ­¤æ›´æ”¹è¿˜ä¿®å¤äº†å¤§é‡æ“ä½œçš„æƒ…å†µã€‚ä¾‹å¦‚ï¼š`union(_:)` äºŒæ¬¡æ€§èƒ½ã€‚ï¼ˆ44760778ï¼‰

*   ä¸ºäº†é˜²æ­¢ `Cocoa` å¯¹è±¡çš„ä¸ä¸€è‡´å“ˆå¸Œï¼Œ`NSObject` ä¸Šçš„ [hashValue](https://developer.apple.com/documentation/objectivec/nsobject/1418615-hashvalue) å±æ€§ä¸å†æ˜¯å¯é‡å†™çš„ã€‚åœ¨ `Swift 4.2` åºŸå¼ƒé‡å†™ `hashValue`ã€‚è¦åœ¨ `NSObject` å­ç±»ä¸­é‡å†™å±æ€§ [hash](https://developer.apple.com/documentation/objectivec/nsobjectprotocol/1418859-hash) æ¥è‡ªå®šä¹‰å“ˆå¸Œå€¼ã€‚ä¸‹é¢å±•ç¤ºä¸€ä¸ªä¾‹å­:

    ```swift
    class Person: NSObject {
        let name: String

        init(name: String) {
            self.name = name
            super.init()
        }

        override func isEqual(_ other: Any?) -> Bool {
            guard let other = other as? Person else { return false }
            return other.name == self.name
        }

        override var hash: Int {
            var hasher = Hasher()
            hasher.combine(name)
            return hasher.finalize()
        }
    }
    ```

    å“ˆå¸Œå’Œç›¸ç­‰åˆ¤æ–­æ˜¯ç›¸è¾…ç›¸æˆã€‚å¦‚æœé‡å†™ `hash`ï¼Œè¿˜éœ€è¦è¦†ç›– `isEqual(_:)`ï¼Œåä¹‹äº¦ç„¶ã€‚(42623458)

*   [DictionaryLiteral](https://developer.apple.com/documentation/swift/dictionaryliteral) ç±»å‹æ”¹åæˆ [KeyValuePairs](https://developer.apple.com/documentation/swift/keyvaluepairs)ã€‚ (SE-0214) (23435865)

*   `Swift` å­—ç¬¦ä¸²æ¡¥æ¥åˆ° `Objective-C` å¯èƒ½é€‚å½“åœ°åœ¨ [CFStringGetCStringPtr(_:_:)](https://developer.apple.com/documentation/corefoundation/1542133-cfstringgetcstringptr) è¿”å›é `nil` å€¼ï¼Œè€Œä» `UTF8String` æ–¹æ³•è¿”å›çš„æŒ‡é’ˆåˆ™ç»‘å®šåˆ°å­—ç¬¦ä¸²çš„ç”Ÿå‘½å‘¨æœŸï¼Œè€Œä¸æ˜¯æœ€å†…å±‚çš„è‡ªåŠ¨é‡Šæ”¾æ± ã€‚æ­£ç¡®çš„ç¨‹åºåº”è¯¥ä¸ä¼šæœ‰ä»»ä½•é—®é¢˜ï¼Œå¹¶å¯èƒ½çœ‹åˆ°æ˜¾è‘—çš„åŠ é€Ÿã€‚ä½†æ˜¯ï¼Œå®ƒå¯èƒ½å¯¼è‡´ä»¥å‰æœªæµ‹è¯•çš„ä»£ç è¿è¡Œï¼Œä»è€Œæš´éœ²æ½œåœ¨çš„bugï¼›ä¾‹å¦‚ï¼Œå¦‚æœå¯¹é nil å€¼è¿›è¡Œæ£€æŸ¥ï¼Œè¯¥åˆ†æ”¯å¯èƒ½ä»æœªåœ¨ `Swift 5` ä¹‹å‰è¢«æ‰§è¡Œè¿‡ã€‚(26236614)

*   [Sequence](https://developer.apple.com/documentation/swift/sequence) åè®®ä¸å†å…·æœ‰ `SubSequence` å…³è”ç±»å‹ã€‚ä»¥å‰è¿”å›å­åºåˆ—çš„ `Sequence` ä¸Šçš„æ–¹æ³•ç°åœ¨è¿”å›å…·ä½“ç±»å‹ã€‚ä¾‹å¦‚ï¼Œ[suffix(_:)](https://developer.apple.com/documentation/swift/sequence/3128822-suffix) ç°åœ¨è¿”å›ä¸€ä¸ªæ•°ç»„ã€‚(45761817)
    
    ä½¿ç”¨å­åºåˆ—çš„åºåˆ—ä¸Šçš„æ‰©å±•åº”è¯¥ä¿®æ”¹ä¸ºç±»ä¼¼åœ°ä½¿ç”¨å…·ä½“ç±»å‹ï¼Œæˆ–è€…ä¿®æ”¹ä¸º [Collection](https://developer.apple.com/documentation/swift/collection) ä¸Šçš„æ‰©å±•(å¦‚æœå­åºåˆ—ä»ç„¶å¯ç”¨)ã€‚

    ä¾‹å¦‚ï¼š

    ```swift
    extension Sequence {
        func dropTwo() -> SubSequence {
            return self.dropFirst(2)
        }
    }
    ```

    å˜ä¸ºï¼š

    ```swift
    extension Sequence {
        func dropTwo() -> DropFirstSequence<Self> { 
            return self.dropFirst(2)
        }
    }
    ```

    æˆ–è€…ï¼š

    ```swift
    extension Collection {
        func dropTwo() -> SubSequence {
            return self.dropFirst(2)
        }
    }
    ```

*   [String](https://developer.apple.com/documentation/swift/string) ç»“æ„çš„æœ¬åœ°ç¼–ç ä» `UTF-16` è½¬æ¢ä¸º `UTF-8`ï¼Œè¿™å¯èƒ½ä¼šæé«˜ `String.UTF8View` ç›¸å¯¹ `String.UTF16View` çš„æ€§èƒ½ã€‚è€ƒè™‘é‡æ–°è¯„ä¼°ä½¿ç”¨ `String.UTF16View` æ¥è°ƒä¼˜æ€§èƒ½çš„ä»£ç ã€‚(42339222)

#### å·²çŸ¥çš„é—®é¢˜

*   Xcode 10.2 beta ç‰ˆæœ¬ [Sequence](https://developer.apple.com/documentation/swift/sequence?language=objc) åè®®ä¸­å¢åŠ çš„ ```count(where:)``` æ–¹æ³•å·²ç»è¢«ç§»é™¤ã€‚(47549309)
**è§£å†³æ–¹æ¡ˆï¼š**ä½¿ç”¨ [reduce(_:_:)](https://developer.apple.com/documentation/swift/anycollection/2906169-reduce?language=objc) å¯ä»¥é«˜æ•ˆç‡åœ°è®¡ç®—ä¸è°“è¯åŒ¹é…çš„å‡ºç°æ¬¡æ•°ï¼š
```swift
let occurrences = sequence.reduce(0) { predicate($1) ? $0 + 1 : $0 }
```

#### å·²è§£å†³çš„é—®é¢˜

*   å¯ä»¥æŒ‰é¢„æœŸåœ¨å­—ç¬¦ä¸²ä¸Šè®¾ç½® `utf8` å±æ€§ã€‚(47864538)

*   ä¼ é€’ null [UnsafeBufferPointer](https://developer.apple.com/documentation/swift/unsafebufferpointer?language=objc)<UInt8> ç»™ [String](https://developer.apple.com/documentation/swift/string?language=objc) ç»“æ„ä½“çš„ [init(decoding:as:)](https://developer.apple.com/documentation/swift/string/2907004-init?language=objc) åˆå§‹åŒ–æ–¹æ³•ç°åœ¨å¯ä»¥æ­£å¸¸çš„è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚ (47864610)


- Swift åŒ…ç®¡ç†ï¼ˆSwift Package Managerï¼‰

#### æ–°ç‰¹æ€§

*   å½“ä½¿ç”¨ `Swift 5 Package.swift tools-version` æ—¶ï¼Œ`Targets` å¯ä»¥å£°æ˜ä¸€äº›å¸¸ç”¨çš„ã€ç‰¹å®šäºç›®æ ‡çš„æ„å»ºè®¾ç½®ã€‚è¿˜å¯ä»¥æ ¹æ®å¹³å°å’Œæ„å»ºé…ç½®å¯¹æ–°è®¾ç½®è¿›è¡Œæ¡ä»¶è®¾ç½®ã€‚æ‰€åŒ…å«çš„æ„å»ºè®¾ç½®æ”¯æŒ `Swift` å’Œ `C` è¯­è¨€å®šä¹‰ã€`C` è¯­è¨€å¤´æ–‡ä»¶æœç´¢è·¯å¾„ã€é“¾æ¥åº“å’Œé“¾æ¥ frameworkã€‚(SE-0238)(23270646)

*   å½“ä½¿ç”¨ `Swift 5 Package.swift tools-version` æ—¶ï¼Œå¯ä»¥æŒ‡å®šæœ€ä½éƒ¨ç½²ç‰ˆæœ¬ã€‚å¦‚æœåŒ…çš„ä»»ä½•åŒ…ä¾èµ–é¡¹æŒ‡å®šçš„æœ€å°éƒ¨ç½²ç›®æ ‡å¤§äºåŒ…æœ¬èº«çš„æœ€å°éƒ¨ç½²ç›®æ ‡ï¼Œåˆ™æ„å»ºä¼šå‡ºç°é”™è¯¯ã€‚(SE-0236) (28253354)

*   ä¸€ä¸ªæ–°çš„ä¾èµ–é¡¹é•œåƒç‰¹æ€§å…è®¸é¡¶çº§åŒ…è¦†ç›–ä¾èµ–é¡¹urlã€‚(SE-0219)(42511642)

    ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è®¾ç½®é•œåƒï¼š
    ```
    $ swift package config set-mirror \
    --package-url <original URL> --mirror-url <mirror URL>
    ```

*   `swift test` å‘½ä»¤å¯ä»¥ä»¥ä¸€ç§æ ‡å‡†æ ¼å¼ç”Ÿæˆä»£ç è¦†ç›–ç‡æ•°æ®ï¼Œè¿™ç§æ ¼å¼é€‚åˆä½¿ç”¨æ ‡è®° `--enable-code-coverage` çš„å…¶ä»–ä»£ç è¦†ç›–ç‡å·¥å…·ä½¿ç”¨ã€‚ç”Ÿæˆçš„ä»£ç è¦†ç›–ç‡æ•°æ®åœ¨`<build-dir>/<configuration>/codecov` ä¸­å¯ç”¨ã€‚(44567442)

*   `Swift 5` ä¸å†æ”¯æŒ `Swift 3 Package.swift tools-version`ã€‚ä»ç„¶åœ¨ `Swift 3 Package.swift tools-version` çš„åŒ…åº”è¯¥æ›´æ–°åˆ°ä¸€ä¸ªæ–°ç‰ˆæœ¬ã€‚(41974124)

*   åŒ…ç®¡ç†å™¨å¤„ç†å¤§å‹åŒ…çš„é€Ÿåº¦æ˜¾è‘—åŠ å¿«äº†ã€‚(35596212)

*   Swift åŒ…ç®¡ç†å™¨æœ‰ä¸€ä¸ªæ–°çš„ `--disable-automatic-resolution` æ ‡å¿—ï¼Œå®ƒå¼ºåˆ¶åŒ…è§£æåœ¨åŒ…å¤±è´¥æ—¶å¤±æ•ˆã€‚å·²è§£æé¡¹ä¸å†ä¸ `Package.swift manifest` æ–‡ä»¶ä¸­æŒ‡å®šçš„ä¾èµ–é¡¹ç‰ˆæœ¬å…¼å®¹ã€‚è¿™ä¸ªç‰¹æ€§å¯¹äºæŒç»­é›†æˆç³»ç»Ÿæ£€æŸ¥åŒ… `Package.resolved` æ˜¯å¦è¿‡æœŸéå¸¸æœ‰ç”¨ã€‚(45822895)

*   `swift run` å‘½ä»¤æœ‰ä¸€ä¸ªæ–°çš„ `--repl` é€‰é¡¹ï¼Œè¯¥é€‰é¡¹å¯åŠ¨ `Swift REPL`ï¼Œæ”¯æŒå¯¼å…¥ç›®æ ‡åŒ…çš„åº“ã€‚è¿™ä½¿æ‚¨å¯ä»¥è½»æ¾åœ°ä»åŒ…ç›®æ ‡æµ‹è¯•APIï¼Œè€Œä¸éœ€è¦æ„å»ºè°ƒç”¨è¯¥APIçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚(44889181)

*   æœ‰å…³ä½¿ç”¨SwiftåŒ…ç®¡ç†å™¨çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—®ä¸Š [swift.org](https://swift.org/) çš„ [Using the Package Manager](https://swift.org/getting-started/#using-the-package-manager)ã€‚


- Swift ç¼–è¯‘å™¨ï¼ˆSwift Compilerï¼‰

## Swift Compiler

#### æ–°ç‰¹æ€§

* ä¸ºäº†å‡å°‘ Swift å…ƒæ•°æ®çš„å ç”¨ä½“ç§¯ï¼ŒSwift ä¸­çš„ convenience initializers ç°åœ¨å°†ä¸ä¼šæå‰åˆ†é…å†…å­˜ç©ºé—´ï¼Œé™¤éå…¶è°ƒç”¨äº†åœ¨ Objective-C ä¸­å®šä¹‰çš„ designated initializer. å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™ä¸ä¼šå¯¹ä½ çš„ app äº§ç”Ÿä»»ä½•å½±å“ã€‚å”¯ä¸€ä¾‹å¤–æ˜¯å½“ä½ çš„ convenience Initializers è¢« Objective-C è°ƒç”¨ï¼ŒåŒæ—¶ï¼Œæ²¡æœ‰è°ƒç”¨è‡ªèº«æš´éœ²ç»™ Objective-Cçš„ `self.init` ï¼Œé‚£ä¹ˆ[æœ€åˆå§‹åˆ†é…çš„å†…å­˜ç©ºé—´](https://developer.apple.com/documentation/objectivec/nsobject/1571958-alloc?language=objc)ä¼šåœ¨æ²¡æœ‰è°ƒç”¨ä»»ä½• initializer ä¸‹è¢«é‡Šæ”¾æ‰ã€‚è¿™å¯èƒ½ä¼šå¯¹ä½¿ç”¨ initializer çš„äººäº§ç”Ÿå›°æ‰°ï¼Œå› ä¸ºä»–ä»¬å¹¶æ²¡æœ‰æ„è¯†æœ‰ object replacement çš„å‘ç”Ÿã€‚ä¸€ä¸ªä¾‹å­æ˜¯ [`initWithCoder:`](https://developer.apple.com/documentation/foundation/nscoding/1416145-initwithcoder?language=objc)ï¼š[`NSKeyedUnarchiver`](https://developer.apple.com/documentation/foundation/nskeyedunarchiver?language=objc) å¦‚æœè°ƒç”¨äº†åœ¨ Swift ä¸­å®šä¹‰çš„ `initWithCoder:` å¹¶ä¸”ä¿å­˜äº†å­˜åœ¨å¾ªç¯çš„å¯¹è±¡å›¾ï¼Œå®ƒæœ€åçš„å®ç°å°†ä¼šå‡ºé”™ã€‚

  è¦é¿å…è¿™æ ·çš„é—®é¢˜ï¼Œä½ éœ€è¦ä¿è¯ convenience initializers ä¸æ”¯æŒ object replacementï¼ŒåŒæ—¶ï¼Œç¡®ä¿æœ€ç»ˆè°ƒç”¨çš„ initializers æš´éœ²ç»™ Objective-Cï¼Œè¿™å¯ä»¥æ˜¯åœ¨ Objective-C ä¸­å®šä¹‰ initializersï¼Œæˆ–æ˜¯è¢«æ ‡è®°äº† `@objc`ï¼Œäº¦æˆ–æ˜¯ä»–ä»¬è¢«æš´éœ²ç»™ Objective-C çš„ initializers è¦†å†™äº†ï¼Œä¹Ÿå¯ä»¥æ˜¯ä»–ä»¬éµä»ä»»ä½•ä¸€ä¸ªæ ‡è®°äº† `@objc` çš„åè®®ã€‚

* è¶…è¿‡ 16 å­—èŠ‚å¯¹é½çš„ C è¯­è¨€ç±»å‹å·²ä¸å†è¢« Swift æ”¯æŒã€‚å…¶å®ï¼Œä¹‹å‰ç‰ˆæœ¬ Swift ç¼–è¯‘å™¨ä¹Ÿæ²¡æœ‰æ­£ç¡®çš„å¤„ç†è¿™äº›ç±»å‹è¿‡ã€‚(31411216)

* åœ¨ Swift 5 æ¨¡å¼ä¸­ï¼Œé `final` ç±»çš„ convenience initializer ä¸­ Self çš„ç±»å‹æ˜¯åŠ¨æ€çš„ Self ç±»å‹ï¼Œè€Œéå…·ä½“ç±»å‹äº†ã€‚(47323459)

* åœ¨ `optimized build`ï¼ˆ`-O` å’Œ `-Osize`ï¼‰ è®¾ç½®ä¸‹ï¼Œç‹¬å å†…å­˜è®¿é—®ä¼šåœ¨ runtime ä¸­é»˜è®¤å¼ºåˆ¶å¯ç”¨ã€‚è‹¥ç¨‹åºåœ¨ runtime ä¸­è¿åç‹¬å å†…å­˜è®¿é—®ï¼Œåˆ™ç¨‹åºä¼šäº§ç”Ÿä¸€æ¡è¯Šæ–­ä¿¡æ¯ï¼šâ€œSimultaneous accesses to [â€¦], but modification requires exclusive access"ã€‚ä½ å¯ä»¥é€šè¿‡ç”¨å‘½ä»¤è¡Œæ ‡è®° -enforce-exclusivity=unchecked æ¥ç¦ç”¨æ£€æŸ¥ï¼Œä½†æ˜¯å¯èƒ½ä¼šå¯¼è‡´äº§ç”ŸæœªçŸ¥çš„ç»“æœã€‚Runtime ä¸­è¿åç‹¬å å†…å­˜è®¿é—®ä¸€èˆ¬ä¼šæ˜¯ç”±åŒæ—¶å¯¹ç±»å±æ€§å’Œå…¨å±€å˜é‡ï¼ˆåŒ…æ‹¬é¡¶å±‚ä»£ç ä¸­çš„å˜é‡å’Œè¢«é€ƒé€¸é—­åŒ…æŒæœ‰çš„å˜é‡ï¼‰åŒæ—¶è®¿é—®å¯¼è‡´çš„ã€‚æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ [Swift 5 Exclusivity Enforcement](https://swift.org/blog/swift-5-exclusivity/). ([SR-7139](https://bugs.swift.org/browse/SR-7139)) (37830912)

* ç§»é™¤å¯¹ Swift 3 çš„æ”¯æŒã€‚ç°åœ¨ç¼–è¯‘å™¨æ”¯æŒçš„ `-swift-version` æ˜¯ 4ï¼Œ4.2 å’Œ 5ã€‚

* åœ¨ Swift 5 ä¸­ï¼Œåœ¨ Switch ä¸­éå†åœ¨ Objective-C ä¸­å®šä¹‰çš„ï¼Œæˆ–ç”±ç³»ç»Ÿæ¡†æ¶å®šä¹‰çš„æšä¸¾æ—¶ï¼Œå°†è¢«è¦æ±‚å¤„ç† unknown caseã€‚Unknown case æœ‰å¯èƒ½æ¥è‡ªäºåæ¥æ–°å¢æˆ–åœ¨ Objective-C çš„ `.m` æ–‡ä»¶é‡Œè¿›è¡Œç§æœ‰å®šä¹‰ã€‚ä¹‹å‰ï¼ŒObjective-C å…è®¸æšä¸¾å˜é‡å‚¨å­˜ç¬¦åˆå®šä¹‰ç±»å‹çš„ä»»ä½•å€¼ã€‚è¿™äº›æƒ…å†µç°åœ¨éƒ½å¯ä»¥ç”¨æ–°çš„  `@unknown default` æ¥å¤„ç†ã€‚ä¸ç”¨æ‹…å¿ƒï¼Œç¼–è¯‘å™¨ä¾ç„¶ä¼šå¯¹æ¼æ‰çš„ case è¿›è¡Œè­¦å‘Šã€‚å½“ç„¶ï¼Œæ™®é€šçš„ `default` ä¹Ÿæ˜¯å¯ä»¥å¤„ç†çš„ã€‚

  å¦‚æœä½ åœ¨ Objective-C è‡ªå®šä¹‰äº†æšä¸¾å˜é‡ï¼Œä¹Ÿä¸éœ€è¦å®¢æˆ·ç«¯å¯¹æœªçŸ¥æƒ…å†µè¿›è¡Œå¤„ç†çš„è¯ï¼Œé‚£ä¹ˆï¼Œä½ å¯ä»¥ä½¿ç”¨ `NS_CLOSED_ENUM` å®æ¥ä»£æ›¿ `NS_ENUM`ã€‚ Swift ç¼–è¯‘å™¨ä¼šè¯†åˆ«è¿™äº›å®ï¼Œä¹‹åï¼Œå°±ä¸ä¼šå†è¦æ±‚å¯¹ `default` case å¤„ç†äº†ã€‚

åœ¨ Swift 4 å’Œ Swift 4.2 æ¨¡å¼ä¸‹ï¼Œä½ è¿˜æ˜¯å¯ä»¥ä½¿ç”¨ `@unknown default` è¿›è¡Œå¤„ç†ã€‚å¦‚æœä½ æ²¡æœ‰æ·»åŠ  `@unknown default`ï¼Œ è€Œ runtime ä¸­æœ‰æœªçŸ¥ case ä¼ å…¥ï¼Œruntime ä¼šæ•è·åˆ°è¿™æ ·çš„å¼‚å¸¸ï¼Œè¿™å’Œ Xcode 10.1 ä¸­çš„ Swift 4.2 æ˜¯ä¸€è‡´çš„ã€‚([SE-0192](https://github.com/apple/swift-evolution/blob/master/proposals/0192-non-exhaustive-enums.md)) (39367045ï¼‰

* ç°åœ¨ SourceKit ç”Ÿæˆçš„ Swift Modules çš„æ¥å£ä¸­ï¼Œé»˜è®¤å‚æ•°ä¼šè¢«æ˜¾ç¤ºå‡ºæ¥ï¼Œè€Œéä¹‹å‰ç”¨ `placeholder default` æ¥æ˜¾ç¤ºã€‚(18675831)

* `unowned` å’Œ `unowned(unsafe)` å˜é‡ç°å·²æ”¯æŒ [`Optional`](https://developer.apple.com/documentation/swift/optional?language=objc) ç±»å‹ã€‚(47326769)

### Known Issues

* Key Path ä¸­å¦‚æœå¼•ç”¨å¦å¤–ä¸€ä¸ª Swift Module ä¸­ `Protocol Extension` ä¸­çš„å±æ€§ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¼–è¯‘å™¨å¥”æºƒã€‚(48001932)

  æš‚æ—¶è§£å†³æ–¹æ¡ˆï¼šåœ¨å½“å‰ Module ä¸­å®šä¹‰ä¸­é—´å±æ€§ï¼ˆ`wrapper property`ï¼‰ï¼Œåœ¨ key path ä¸­å¼•ç”¨è¿™ä¸ªä¸­é—´å±æ€§è€ŒéåŸæœ‰å±æ€§ã€‚
  
* è‹¥å¯ç”¨`Thread Sanitizer`ï¼Œå¯èƒ½å¯¼è‡´ Swift ç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­å¥”æºƒã€‚

  æš‚æ—¶è§£å†³æ–¹æ¡ˆï¼šåœ¨ `Scheme Editor` çš„ `Diagnostics` æ ‡ç­¾é¡µä¸‹ç¦ç”¨ `Thread Sanitizer`ã€‚
  
* é“¾æ¥é™æ€ Swift åº“å¯èƒ½ä¼šå¯¼è‡´åˆ›å»ºçš„äºŒè¿›åˆ¶ç¨‹åºä¸­ç¼ºå¤±ç±»å‹å…ƒæ•°æ®ï¼ŒåŸå› æ˜¯é™æ€åº“ä¸­çš„å®šä¹‰å…ƒæ•°æ®çš„ Object æ–‡ä»¶è¢«é”™è¯¯çš„å½“åšæœªä½¿ç”¨ã€‚

  è¿™æœ‰å¯èƒ½å¯¼è‡´ä¸€ä¸ª Swift runtime é”™è¯¯ï¼ŒåŒæ—¶ä¼šæœ‰ç±»ä¼¼ â€œfailed to demangle superclass of MyClass from mangled name â€˜<mangled name>â€™â€ çš„é”™è¯¯ä¿¡æ¯ã€‚
  
  æš‚æ—¶è§£å†³æ–¹æ¡ˆï¼šå¦‚æœä½ èƒ½é‡æ–°ç¼–è¯‘é™æ€åº“ï¼Œè¯·å°è¯•å¯ç”¨ `whole module optimization` ä¸‹è¿›è¡Œç¼–è¯‘ã€‚ å¦åˆ™ï¼Œå¯ä»¥è€ƒè™‘æ·»åŠ  `-all_load` åˆ°å®¢æˆ·ç«¯äºŒè¿›åˆ¶ç¨‹åºçš„é“¾æ¥å™¨ä¸­æ¥ä¿è¯æ‰€æœ‰çš„ Object æ–‡ä»¶éƒ½è¢«é“¾æ¥å…¥äºŒè¿›åˆ¶ç¨‹åºã€‚
  
* `self.init()` åœ¨ [NSView](https://developer.apple.com/documentation/appkit/nsview?language=objc) å’Œ [UIView](https://developer.apple.com/documentation/uikit/uiview?language=objc) çš„å­ç±»çš„ designated initializers æœªè¢«ç¦æ­¢ï¼Œå³ä¾¿ `init()` åœ¨ NSView å’Œ UIView ä¸­æ˜¯ convenience initializerã€‚ä½¿ç”¨ `self.init()` å¯èƒ½ä¼šå¯¼è‡´å‚¨å­˜å±æ€§è¢«å¤šæ¬¡åˆå§‹åŒ–ï¼Œæœ€ç»ˆå¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼æˆ–è€…æ˜¯å…¶ä»–é—®é¢˜ã€‚(SR-9836) (47734208)

  æš‚æ—¶è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ `super.init(frame:)` æ¥æ›¿ä»£ `self.init()`

### Resolved Issues

* é™¤éä½ å®‰è£… Swift 5 å‘½ä»¤è¡Œå·¥å…·åŒ…çš„è¿è¡Œæ—¶æ”¯æŒï¼Œå¦åˆ™ Swift å‘½ä»¤è¡Œé¡¹ç›®å°†æ— æ³•åœ¨ macOS 10.14.3 åŠæ›´æ—©ç‰ˆæœ¬ä¸Šè¿è¡Œã€‚ å¦‚æœæ²¡æœ‰è¯¥å·¥å…·åŒ…ï¼ŒSwift å‘½ä»¤è¡Œé¡¹ç›®ä¼šåœ¨å¯åŠ¨æ—¶å› â€œdyldï¼šLibrary not loadedâ€ é”™è¯¯è€Œå´©æºƒã€‚(46824656)

* ç›´æ¥ä»å‘½ä»¤è¡Œç”¨ swiftc ç¼–è¯‘å™¨é“¾æ¥ä¸€ä¸ª Swift é¡¹ç›®ï¼Œç°åœ¨å¯ä»¥åœ¨ macOS Mojave 10.14.4 ä¸Šè¾“å‡ºæ­£ç¡®çš„ç»“æœã€‚(43616773)

* ä¸ Xcode 10.1 ç›¸æ¯”ï¼ŒXcode 10.2 ä¸­çš„ç¼–è¯‘æ—¶é—´å€’é€€ç°åœ¨åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å¾—åˆ°è§£å†³ã€‚ æœ‰äº›é¡¹ç›®å¯èƒ½ä¼šç»§ç»­ç»å†å°å¹…å€’é€€ï¼›æ–‡ä»¶é”™è¯¯æŠ¥å‘Šä¼šè®°å½•æ‚¨é‡åˆ°çš„æ¡ˆä¾‹ã€‚(47304789)

* å³ä½¿å¼•ç”¨äº† [UIAccessibility](https://developer.apple.com/documentation/uikit/uiaccessibility?language=objc) ç»“æ„ä½“çš„æˆå‘˜æˆ–åŒ…å« NS_ERROR_ENUM åµŒå¥—ç±»å‹çš„å…¶ä»–ç±»å‹ï¼ŒSwift ç¼–è¯‘å™¨ä¹Ÿä¼šå®Œæˆâ€œMerge swiftmoduleâ€æ„å»ºæ­¥éª¤ã€‚(47152185)

* åœ¨æŸäº›ä¸Šä¸‹æ–‡ä¸­å…è®¸ä½¿ç”¨å•å…ƒç´ æ ‡è®°çš„å…ƒç»„è¡¨è¾¾å¼ï¼Œå¦‚ (```label:123```)ï¼Œä½†é€šå¸¸ä¼šå¯¼è‡´ä»¤äººæƒŠè®¶çš„ï¼Œä¸ä¸€è‡´çš„è¡Œä¸ºï¼Œè¿™äº›è¡Œä¸ºåœ¨ç¼–è¯‘å™¨ç‰ˆæœ¬ä¸­ä¼šæœ‰æ‰€ä¸åŒã€‚ ä»–ä»¬ç°åœ¨å®Œå…¨è¢«ç¦æ­¢äº†ã€‚
åœ¨ Swift 3 ä¸­å·²ç»ç¦æ­¢ä½¿ç”¨å•å…ƒç´ æ ‡è®°ç±»å‹ï¼Œå¦‚```var x:(labelï¼šInt)```ã€‚([SR-8109](https://bugs.swift.org/browse/SR-8109)) (41474370)

* å¦‚æœ KeyPath å­—é¢é‡å¼•ç”¨äº†åœ¨ Objective-C ä¸­å®šä¹‰çš„å±æ€§æˆ–è€…åœ¨ Swift ä¸­ä½¿ç”¨ @objc å’ŒåŠ¨æ€ä¿®é¥°ç¬¦å®šä¹‰çš„å±æ€§ï¼Œå®ƒ
ç°åœ¨å¯ä»¥æˆåŠŸç¼–è¯‘å¹¶åœ¨è¿è¡Œæ—¶ç”Ÿæˆæ­£ç¡®çš„å“ˆå¸Œå€¼æˆ–ä¸å…¶ä»– KeyPath çš„ç›¸ç­‰æ¯”è¾ƒã€‚(47184763)

* æ‰©å±•ç»‘å®šç°åœ¨æ”¯æŒåµŒå¥—ç±»å‹çš„æ‰©å±•ï¼Œè¿™äº›ç±»å‹æœ¬èº«æ˜¯åœ¨æ‰©å±•å†…å®šä¹‰çš„ã€‚ä¹‹å‰å¯èƒ½ä¼šå› ä¸ºå£°æ˜é¡ºåºé—®é¢˜è€Œå¤±è´¥ï¼Œå‡ºç°â€œundeclared typeâ€é”™è¯¯ã€‚([SR-631](https://bugs.swift.org/browse/SR-631)) (20337822)

* In Swift 5 mode, inferred associated types are no longer exposed publicly when a public type conforms to a non-public protocol. Instead, they get the minimum possible access to be visible from both the protocol and the conforming type. For source compatibility, Swift 4 and 4.2 modes continue to expose inferred associated types as publicly as the enclosing type unless the inferred associated type is itself less public than the conforming type. 

åœ¨ Swift 5 æ¨¡å¼ä¸‹ï¼Œå½“å…¬å…±ç±»å‹å®ç°éå…¬å…±åè®®æ—¶ï¼Œæ¨æ–­çš„å…³è”ç±»å‹ä¸å†å…¬å¼€ã€‚ ç›¸åï¼Œå®ƒä»¬è·å¾—åŒæ—¶å¯¹åè®®å’Œå®ç°ç±»å‹å¯è§çš„æœ€å°è®¿é—®æƒé™ã€‚å¯¹äºç‰ˆæœ¬å…¼å®¹æ€§ï¼ŒSwift 4 å’Œ 4.2 æ¨¡å¼ç»§ç»­å°†æ¨æ–­çš„å…³è”ç±»å‹å…¬å¼€ä¸ºå°é—­ç±»å‹ï¼Œé™¤éæ¨æ–­çš„å…³è”ç±»å‹æœ¬èº«ä¸å¦‚å®ç°ç±»å‹å¼€æ”¾ã€‚(46143405)

* åœ¨ Swift 5 æ¨¡å¼ä¸‹ï¼Œè¿”å› Self çš„ç±»æ–¹æ³•ä¸èƒ½å†ä½¿ç”¨è¿”å›å…·ä½“ç±»ç±»å‹ï¼ˆé finalï¼‰çš„æ–¹æ³•æ¥è¦†ç›–ã€‚è¿™ç±»ä»£ç ä¸æ˜¯ç±»å‹å®‰å…¨çš„ï¼Œéœ€è¦å°†å®ƒä»¬æ”¹æ‰ã€‚ ([SR-695](https://bugs.swift.org/browse/SR-695)) (47322892)
ä¾‹å¦‚ï¼š
```swift
class Base { 
    class func factory() -> Self { /*...*/ }
} 

class Derived: Base {
    class override func factory() -> Derived { /*...*/ } 
} 
```

* åœ¨ Swift 5 æ¨¡å¼ä¸‹ï¼Œç°åœ¨æ˜ç¡®ç¦æ­¢å£°æ˜ä¸åµŒå¥—ç±»å‹åŒåçš„é™æ€å±æ€§ï¼Œè€Œä¹‹å‰å¯ä»¥åœ¨æ³›å‹ç±»å‹çš„æ‰©å±•ä¸­è¿›è¡Œè¿™æ ·çš„å£°æ˜ã€‚([SR-7251](https://bugs.swift.org/browse/SR-7251)) (47325738)
ä¾‹å¦‚ï¼š
```swift
struct Foo<T> {}
extension Foo { 
    struct i {}

    // Error: Invalid redeclaration of 'i'.
    // (Prior to Swift 5, this didnâ€™t produce an error.) 
    static var i: Int { return 0 }
}
```

* ç°åœ¨å¯ä»¥åœ¨å­ç±»ä¸­æ­£ç¡®ç»§æ‰¿å…·æœ‰å¯å˜å‚æ•°çš„æŒ‡å®šåˆå§‹åŒ–å™¨ã€‚(16331406)

* åœ¨ Swift 5 æ¨¡å¼ä¸‹ï¼Œ@autoclosure å‚æ•°ä¸èƒ½å†è¢«è½¬å‘ç»™å¦ä¸€ä¸ªå‡½æ•°è°ƒç”¨çš„ @autoclosure å‚æ•°ã€‚ç›¸åï¼Œä½ å¿…é¡»ä½¿ç”¨æ‹¬å·æ˜¾å¼è°ƒç”¨å‡½æ•°å€¼ã€‚è°ƒç”¨å°†è¢«åŒ…å«åœ¨ä¸€ä¸ªéšå¼é—­åŒ…ä¸­ï¼Œä¿è¯äº†ä¸ Swift 4 æ¨¡å¼ç›¸åŒçš„è¡Œä¸ºã€‚([SR-5719](https://bugs.swift.org/browse/SR-5719)) (37321597)
ä¾‹å¦‚ï¼š
```swift
func foo(_ fn: @autoclosure () -> Int) {}
func bar(_ fn: @autoclosure () -> Int) {
    foo(fn) // Incorrect, `fn` canâ€™t be forwarded and has to be called.
    foo(fn()) // OK
} 
```

* ç°åœ¨å®Œå…¨æ”¯æŒå¤æ‚çš„é€’å½’ç±»å‹å®šä¹‰ï¼ŒåŒ…æ‹¬ä¹‹å‰åœ¨è¿è¡Œæ—¶ä¼šå¯¼è‡´æ­»é”çš„ç±»å’Œæ³›å‹ã€‚(38890298)

* åœ¨ Swift 5 æ¨¡å¼ä¸‹ï¼Œåœ¨å°† Optional å€¼è½¬æ¢ä¸ºé€šç”¨å ä½ç¬¦ç±»å‹æ—¶ï¼Œç¼–è¯‘å™¨åœ¨å±•å¼€å€¼æ—¶ä¼šæ›´åŠ ä¿å®ˆã€‚è¿™ç§è½¬æ¢ç»“æœç°åœ¨æ›´æ¥è¿‘äºéé€šç”¨ä¸Šä¸‹æ–‡ä¸­è·å¾—çš„ç»“æœã€‚([SR-4248](https://bugs.swift.org/browse/SR-4248)) (47326318)
ä¾‹å¦‚ï¼š
```swift
func forceCast<U>(_ value: Any?, to type: U.Type) -> U {
    return value as! U 
} 

let value: Any? = 42
print(forceCast(value, to: Any.self))
// Prints "Optional(42)"
// (Prior to Swift 5, this would print "42".)

print(value as! Any)
// Prints "Optional(42)"
```

* åè®®ç°åœ¨å¯ä»¥å°†ç¬¦åˆç±»å‹é™å®šä¸ºç»™å®šç±»çš„å­ç±»ã€‚æ”¯æŒä¸¤ç§ç­‰æ•ˆå½¢å¼ï¼š
```swift
protocol MyView: UIView { /*...*/ }
protocol MyView where Self: UIView { /*...*/ } 
```
Swift 4.2 æ¥å—äº†ç¬¬äºŒç§å½¢å¼ï¼Œä½†è¿˜æ²¡æœ‰å®Œå…¨å®ç°ï¼Œåœ¨ç¼–è¯‘æ—¶æˆ–è¿è¡Œæ—¶å¶å°”ä¼šå‘ç”Ÿå´©æºƒã€‚([SR-5581](https://bugs.swift.org/browse/SR-5581)) (38077232)

* Swift 4.2 æ¥å—äº†ç¬¬äºŒç§å½¢å¼ï¼Œä½†è¿˜æ²¡æœ‰å®Œå…¨å®ç°ï¼Œåœ¨ç¼–è¯‘æ—¶æˆ–è¿è¡Œæ—¶å¶å°”ä¼šå‘ç”Ÿå´©æºƒã€‚
  * åœ¨ Swift 5 æ¨¡å¼ä¸‹ï¼Œå½“åœ¨è‡ªå·±çš„ didSet æˆ– willSet observer ä¸­è®¾ç½®å±æ€§æ—¶ï¼Œobserver ç°åœ¨åªåœ¨ self ä¸Šè®¾ç½®å±æ€§ï¼ˆä¸ç®¡æ˜¯éšå¼çš„è¿˜æ˜¯æ˜¾å¼çš„ï¼‰æ—¶æ‰ä¼šé¿å…è¢«é€’å½’è°ƒç”¨ã€‚([SR-419](https://bugs.swift.org/browse/SR-419)) (32334826)
  ä¾‹å¦‚ï¼š
```swift
class Node {
    var children = [Node]() 
    var depth: Int = 0 {
        didSet { 
            if depth < 0 {
                // Wonâ€™t recursively call didSet, because this is setting depth on self. 
                depth = 0
            } 

            // Will call didSet for each of the children,
            // as this isnâ€™t setting the property on self.
            // (Prior to Swift 5, this didnâ€™t trigger property
            // observers to be called again.)
            for child in children { 
                child.depth = depth + 1
            } 
        }
    }
}
```

* å¦‚æœä½ ä½¿ç”¨ #sourceLocation å°†ç”Ÿæˆæ–‡ä»¶ä¸­çš„è¡Œæ˜ å°„å›æºä»£ç ï¼Œé‚£ä¹ˆè¯Šæ–­ä¿¡æ¯å°†æ˜¾ç¤ºåœ¨æºæ–‡ä»¶ä¸­è€Œä¸æ˜¯ç”Ÿæˆæ–‡ä»¶ä¸­ã€‚(43647151)

* ä½¿ç”¨æ³›å‹ç±»å‹åˆ«åä½œä¸º @objc æ–¹æ³•çš„å‚æ•°æˆ–è¿”å›ç±»å‹ä¸ä¼šå†ç”Ÿæˆæ— æ•ˆçš„ Objective-C æ ‡å¤´ã€‚([SR-8697](https://bugs.swift.org/browse/SR-8697)) (43347303)

## å†…æ¨

è€å¸æœºå‘¨æŠ¥å›¢é˜Ÿè”åˆçŸ¥è¯†å°é›†å’Œ SwiftGG ç¿»è¯‘ç»„æ”¶å½•äº†ä¸€ä»½é è°±çš„å†…æ¨èŒä½ã€‚

å¦‚æœä½ æƒ³**æ‰¾å·¥ä½œ**ï¼Œç‚¹è¿™é‡Œï¼šhttps://www.yuque.com/iosalliance/article/bhutav

å¦‚æœä½ æƒ³**æ‹›äºº**ï¼Œç‚¹è¿™é‡Œï¼šhttps://www.yuque.com/iosalliance/article/ycyhf3

å½“ç„¶ï¼Œä¹Ÿæ¬¢è¿ä½ å…³æ³¨æˆ‘ä»¬æ¯ä¸€æœŸçš„å‘¨æŠ¥ï¼Œæˆ‘ä»¬ä¼šåœ¨æ¯æœŸå‘¨æŠ¥åº•éƒ¨åŠæ—¶æ›´æ–°ç¼–è¾‘å†…æ¨å²—ä½ã€‚

## å…³æ³¨æˆ‘ä»¬

æˆ‘ä»¬å¼€é€šäº†å…¬ä¼—å·ï¼Œæ¯æœŸå‘å¸ƒæ—¶å…¬ä¼—å·ï¼ˆOldDriverWeeklyï¼‰ä¼šæ¨é€æ¶ˆæ¯ï¼Œæ¬¢è¿å…³æ³¨ã€‚

![](https://github.com/SwiftOldDriver/iOS-Weekly/blob/master/assets/qrcode_for_wechat.jpg?raw=true)

åŒæ—¶ä¹Ÿæ”¯æŒäº† RSS è®¢é˜…ï¼šhttps://github.com/SwiftOldDriver/iOS-Weekly/releases.atom ã€‚

## æœ¬æœŸç¼–è¾‘

[@å››å¨˜](https://kemchenj.github.io)ï¼Œ[@äº«è€³å…ˆæ£®](https://github.com/iblacksun)ï¼Œ[@Damonwong](https://github.com/Damonvvong)ï¼Œ[@æŠ˜è…¾èŒƒå„¿_å‘³ç²¾](http://weibo.com/agvicking)ï¼Œ[@å¼ å˜‰å¤«](https://weibo.com/2949394297)ï¼Œ[@Parsifal](https://weibo.com/parsifalchang)ï¼Œ[@aaaron7](https://weibo.com/aaaron7)ï¼Œ[@kyo](https://github.com/KyoLi)ï¼Œ[@tom510230](https://xiaozhuanlan.com/u/6682065345)ï¼Œ[@anotheren](https://anotheren.com)ï¼Œ[@æ°´æ°´](https://www.xuyanlan.com)ï¼Œ[@looping](https://github.com/looping)ï¼Œ[@è€è€è€è€è€è€è€é©´](https://weibo.com/u/6090610445)ï¼Œ[@å°é86](https://weibo.com/xuyafei86)ï¼Œ[@é‚¦ben](http://weibo.com/linwenbang)ï¼Œ[@çº¢çº¸](https://github.com/nianran)ï¼Œ[@å«ç¬‘é¥®ç ’éœœ](http://chinafish.news)ï¼Œ[@JimQ](https://github.com/waz0820)ï¼Œ[@è€å³°](https://github.com/GesanTung)ï¼Œ[@zvving](https://github.com/zvving)ï¼Œ[@J_Knight_](https://github.com/knightsj)ï¼Œ[@æé€Ÿç”·å­©](https://github.com/ztlyyznf001)

## è¯´æ˜

ğŸš§ è¡¨ç¤ºéœ€ç¿»å¢™ï¼ŒğŸŒŸ è¡¨ç¤ºç¼–è¾‘æ¨è

é¢„è®¡é˜…è¯»æ—¶é—´ï¼šğŸ å¾ˆå¿«å°±èƒ½è¯»å®Œï¼ˆ1 - 10 minsï¼‰ï¼›ğŸ• ä¸­ç­‰ ï¼ˆ10 - 20 minsï¼‰ï¼›ğŸ¢ æ…¢ï¼ˆ20+ minsï¼‰


